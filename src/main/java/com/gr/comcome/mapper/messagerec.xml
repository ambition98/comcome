<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gr.comcome.messagebox.model.MessageRecvDAO">
	<sql id="searchWhere">
      <if test="searchKeyword!=null and searchKeyword!=''">
             where ${searchCondition} like '%' || #{searchKeyword} || '%'
      </if>      
   </sql>
<select id="selectAll" parameterType="searchVo" resultType="MessageBoxRecVO">
      select *
      from
      (
          select rownum as RNUM, A.*
          from
          (
              select * from message_recv
              <include refid="searchWhere"></include>
              order by message_no desc
          )A
      )
      <![CDATA[
      where RNUM>#{firstRecordIndex} 
         and RNUM<=#{firstRecordIndex}+ #{recordCountPerPage}]]>
 </select>
 
 <select id="selectTotalRecord" parameterType="searchVo" resultType="int">
      select count(*) from message_recv
      <include refid="searchWhere"></include>   
   </select>
   
     <insert id="insertMessageRecv">
     <selectKey keyProperty="messageNo" resultType="int" order="BEFORE">
			select "COMCOME"."ISEQ$$_78758".CURRVAL from dual
		</selectKey>
		INSERT INTO message_recv(	
		message_no,
		account_no	
		)
		VALUES( 
		#{messageNo}	,
		#{accountNo}		
		)
	</insert>
	
</mapper>